# Idun Agent Manager - OIDC configuration examples
# Copy this file to .env and fill values for ONE provider section.

# --- Common server config ---
ENVIRONMENT=development
API__PORT=8000  # Not read by app code; used by process manager/uvicorn

# --- OIDC common (required for all providers) ---
# Select ONE provider: okta | auth0 | entra | google
AUTH__PROVIDER_TYPE=okta

# Issuer: OIDC discovery base URL
# okta:   https://<okta-domain>/oauth2/default
# auth0:  https://<tenant>.auth0.com/
# entra:  https://login.microsoftonline.com/<tenant_id>/v2.0
# google: https://accounts.google.com
AUTH__ISSUER=

# Client credentials
AUTH__CLIENT_ID=
AUTH__CLIENT_SECRET=

# Redirect URI configured in the IdP application
AUTH__REDIRECT_URI=http://localhost:8000/api/v1/auth/callback

# Scopes
AUTH__SCOPES=["openid","profile","email"]

# Verification tuning
AUTH__ALLOWED_ALGS=["RS256","RS512","ES256"]
AUTH__JWKS_CACHE_TTL=300
AUTH__CLOCK_SKEW_SECONDS=60

# Optional audiences (Auth0/Entra APIs). If set, first value is used.
AUTH__EXPECTED_AUDIENCES=[]  # Optional; only used when validating API access tokens

# Optional claim mapping overrides (JSON arrays). Leave empty for sensible defaults.
# Examples: AUTH__CLAIM_ROLES_PATHS=[["https://your-domain/roles"],["roles"]]
AUTH__CLAIM_USER_ID_PATH=   # Optional override; not required by default
AUTH__CLAIM_EMAIL_PATH=     # Optional override; not required by default
AUTH__CLAIM_ROLES_PATHS=    # Optional override; not required by default
AUTH__CLAIM_GROUPS_PATHS=   # Optional override; not required by default
AUTH__CLAIM_WORKSPACE_IDS_PATHS=  # Optional; only if you embed workspace IDs in tokens


# ========================
# Provider-specific guides
# ========================

## Okta
# AUTH__PROVIDER_TYPE=okta
# AUTH__ISSUER=https://YOUR_OKTA_DOMAIN/oauth2/default
# AUTH__CLIENT_ID=YOUR_CLIENT_ID
# AUTH__CLIENT_SECRET=YOUR_CLIENT_SECRET
# Usually no audience needed for ID tokens. If validating access tokens for an API, set:
# AUTH__EXPECTED_AUDIENCES=["api://default"]  # Optional if you don't validate access tokens

## Auth0
# AUTH__PROVIDER_TYPE=auth0
# AUTH__ISSUER=https://YOUR_TENANT.auth0.com/
# AUTH__CLIENT_ID=YOUR_CLIENT_ID
# AUTH__CLIENT_SECRET=YOUR_CLIENT_SECRET
# API audience is typically required for access tokens:
# AUTH__EXPECTED_AUDIENCES=["https://your-api-identifier"]  # Optional if you don't validate access tokens
# Roles are often in a namespaced custom claim:
# AUTH__CLAIM_ROLES_PATHS=[["https://your-domain/roles"],["roles"],["permissions"]]  # Optional; only if you add namespaced roles

## Microsoft Entra ID (Azure AD)
# AUTH__PROVIDER_TYPE=entra
# AUTH__ISSUER=https://login.microsoftonline.com/YOUR_TENANT_ID/v2.0
# AUTH__CLIENT_ID=YOUR_APP_REGISTRATION_CLIENT_ID
# AUTH__CLIENT_SECRET=YOUR_CLIENT_SECRET
# For API access tokens, set audience to application ID URI or client_id:
# AUTH__EXPECTED_AUDIENCES=["api://YOUR-APP-ID-URI"]  # Optional if you don't validate access tokens
# Helpful mappings:
# AUTH__CLAIM_USER_ID_PATH=["oid"]  # Optional override
# AUTH__CLAIM_EMAIL_PATH=["preferred_username"]  # Optional override
# AUTH__CLAIM_ROLES_PATHS=[["roles"],["groups"]]  # Optional override

## Google Cloud Identity / Google Workspace
# AUTH__PROVIDER_TYPE=google
# AUTH__ISSUER=https://accounts.google.com
# AUTH__CLIENT_ID=YOUR_OAUTH_CLIENT_ID
# AUTH__CLIENT_SECRET=YOUR_OAUTH_CLIENT_SECRET
# For ID tokens, audience is typically the client_id (default behavior). Optionally:
# AUTH__EXPECTED_AUDIENCES=["YOUR_OAUTH_CLIENT_ID"]  # Optional
# Optionally restrict hosted domain (hd) at your app level.

# Environment Configuration
ENVIRONMENT=development
DEBUG=true  # Not used by app currently
TESTING=false  # Not used by app currently

# Server Configuration
HOST=0.0.0.0  # Not read by app; used by process manager
PORT=8000     # Not read by app; used by process manager
WORKERS=1     # Not read by app; used by process manager
RELOAD=true   # Not read by app; used by process manager

# Database Configuration
DATABASE__URL=postgresql+asyncpg://postgres:postgres@localhost:55432/idun_agents
DATABASE__ECHO=false
DATABASE__POOL_SIZE=10
DATABASE__MAX_OVERFLOW=20
DATABASE__POOL_PRE_PING=true

# Redis Configuration
REDIS__URL=redis://localhost:6379/0
REDIS__MAX_CONNECTIONS=20

# Authentication Configuration
AUTH__SECRET_KEY=your-super-secret-key-at-least-32-characters-long  # Unused currently (legacy JWT)
AUTH__ALGORITHM=HS256  # Unused currently (legacy JWT)
AUTH__ACCESS_TOKEN_EXPIRE_MINUTES=30  # Unused currently (legacy JWT)
AUTH__REFRESH_TOKEN_EXPIRE_DAYS=7  # Unused currently (legacy JWT)

# OAuth2/OIDC Configuration (optional)
AUTH__OAUTH_CLIENT_ID=  # Not used (legacy oauth handler not wired)
AUTH__OAUTH_CLIENT_SECRET=  # Not used (legacy oauth handler not wired)
AUTH__OAUTH_SERVER_URL=  # Not used (legacy oauth handler not wired)
AUTH__OAUTH_REDIRECT_URI=  # Not used (legacy oauth handler not wired)

# Observability Configuration
OTEL__SERVICE_NAME=idun-agent-manager  # Not used yet
OTEL__EXPORTER_ENDPOINT=  # Not used yet
OTEL__EXPORTER_HEADERS=  # Not used yet
OTEL__LOG_LEVEL=INFO  # Used (logging)
OTEL__LOG_FORMAT=json  # Used (logging)

# Celery Configuration
CELERY__BROKER_URL=redis://localhost:6379/1  # Not used yet
CELERY__RESULT_BACKEND=redis://localhost:6379/2  # Not used yet
CELERY__TASK_SERIALIZER=json  # Not used yet
CELERY__RESULT_SERIALIZER=json  # Not used yet
CELERY__TIMEZONE=UTC  # Not used yet

# API Configuration
API__TITLE=Idun Agent Manager API  # Used (health/version)
API__DESCRIPTION=Modern FastAPI backend for managing AI agents  # Not used
API__VERSION=0.1.0  # Used (health/version)
API__DOCS_URL=/docs  # Not used (main sets docs statically)
API__REDOC_URL=/redoc  # Not used (main sets redoc statically)
API__OPENAPI_URL=/openapi.json  # Not used

# CORS Configuration
API__CORS_ORIGINS=["http://localhost:3000","http://localhost:8080"]  # Not used (CORS is * in code)
API__CORS_METHODS=["*"]  # Not used
API__CORS_HEADERS=["*"]  # Not used

# Rate Limiting
API__RATE_LIMIT_ENABLED=true  # Not used
API__RATE_LIMIT_REQUESTS=100  # Not used
API__RATE_LIMIT_WINDOW=60  # Not used